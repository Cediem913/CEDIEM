<div>
    {{#each service}}
    <div class="row">
        <div class="col-md-6 align-self-center ">
            <div class="card">
                <div class="card-body">
                    <img class="rounded mx-auto d-block w-100 img-responsive"
                        src="https://res.cloudinary.com/dinzw8gc3/image/upload/v1564937147/CEDIEM/Website/services/{{id_root}}/{{Image}}"
                        alt="{{service}}">
                </div>
            </div>
        </div>
        <div class="col-md-6">

            <div class="card">
                <div class="card-header">
                    <p id="service-name" class="newarrival text-center">{{Name}}</p>
                    <p class="price">MXN ${{Price}}</p>
                </div>
                <div class="card-body">
                    <p><b>Area: </b>{{id_root}}</p>
                    <p><b>Horas por sesion: </b>{{Duration}}</p>
                    <p><b>Fecha de inicio: </b><input id="fechaInicio" type='hidden' value="2009-12-19" class="form-control apprvd_input_date" onfocusout="asignarFecha()" readonly="readonly"/></p>
                    <p><b>Hora de inicio:
                        <!--<div class='input-group date' id='datetimepicker10'>
                            <input type='text' class="form-control" />
                            <span class="input-group-addon">
                                Calendario
                            </span>
                        </div>-->
                        
                    <div id="arrayContenedor">
                        
                    </div>

                    </p>
                    <p><b>Encargado: </b>{{Owner}}</p>
                    <p><b>Type: </b>{{Type}}</p>
                    <p ><b>Description: {{Description}}</b></p>
                </div>
                <div class="card-footer">
                    <!--{{#if ...user.id_user}}
                    <form
                        action="/aceptarPago?id_user={{...user.id_user}}&product={{id_service}}&price={{Price}}&startDate={{StartDate}}&endDate={{EndDate}}&map={{Map}}"
                        method="POST">
                        <script src="https://checkout.stripe.com/checkout.js" class="stripe-button"
                            data-key="pk_test_gaby5qpjEypGf8MJnH20RSQD00z5Ec16AQ" data-amount="{{Price}}"
                            data-email="a@a.c" data-currency="mxn" data-name="CEDIEM - {{id_service}}"
                            data-description="Compra protegida por stripe"
                            data-image="https://res.cloudinary.com/dinzw8gc3/image/upload/v1565068700/CEDIEM/Website/Structure/icon_cwxeqe.png"
                            data-locale="auto">
                            </script>
                        <script>
                            document.getElementsByClassName('stripe-button-el')[0].style.display = 'none';
                        </script>
                        <button id="botonPagoStripe" class="btn btn-default cart">
                            Apartar fecha<i></i>
                        </button>
                    </form>
                    {{else}}
                    <a class="btn btn-default cart" href="/acceso"> Apartar fecha<i></i></a>
                    {{/if}}-->
                    
                    <a class="btn btn-default cart" onclick="comprar()" href="#"> Apartar fecha<i></i></a>
                </div>
            </div>
        </div>
    </div>
    
    <div class="row">
        <div class="col-md-6 align-self-center">
            <div class="card">
                <div class="card-header">
                    <p>PDF:</p>
                </div>
                <div class="card-body">
                    <iframe
                        src="https://res.cloudinary.com/dinzw8gc3/image/upload/v1564937147/CEDIEM/Website/roots/{{id_root}}/{{File}}"
                        width="100%" height="512"></iframe>
                </div>
            </div>
        </div>

        <div class="col-md-6 align-self-center">
            <div class="card">
                <div class="card-header">
                    <p>Informacion:</p>
                </div>
                <div class="card-body">
                    <p>{{Info}}</p>
                </div>
            </div>
        </div>
        
        <div class="col-md-12 align-self-center">
            <div class="card">
                <div class="card-header">
                    <p>Aulas: <button id="off" onclick="ver()">VER</button></p>
                </div>
                <div class="card-body">
                    <div id="carouselExampleControls" class="carousel slide" data-ride="carousel">
                    <div class="carousel-inner">
                        {{#each ../rooms}}
                        <div class="carousel-item {{#if isIndex}}active{{/if}}">
                        <img class="d-block w-100" src="https://dummyimage.com/600x400/000/fff" alt="">
                            <div class="carousel-caption">
                                <h6>{{Name}} - {{Location}}</h6>
                                <button class="btn btn-default cart" id="{{id_room}}" onclick="asignarRoom('{{id_room}}',{{Location}})">seleccionar</button>
                            </div>
                        </div>
                        {{/each}}
                    </div>
                    <a class="carousel-control-prev" href="#carouselExampleControls" role="button" data-slide="prev">
                        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                        <span class="sr-only">Previous</span>
                    </a>
                    <a class="carousel-control-next" href="#carouselExampleControls" role="button" data-slide="next">
                        <span class="carousel-control-next-icon" aria-hidden="true"></span>
                        <span class="sr-only">Next</span>
                    </a>
                    </div>
                </div>
            </div>
        </div>

        <div class="col-md-12 align-self-center">
            <div class="card">
                <div class="card-header">
                    <p>Mapa:</p>
                </div>
                <div class="card-body">
                    <div id="map"></div>
                    <script>
                        // Initialize and add the map
                        function initMap(data,data1) {
                            // The location of Uluru
                            var uluru = { lat:data,lng:data1 };                
                            // The map, centered at Uluru
                            var map = new google.maps.Map(
                                document.getElementById('map'), { zoom: 5, center: uluru });
                            // The marker, positioned at Uluru
                            var marker = new google.maps.Marker({ position: uluru, map: map });
                        }
                    </script>
                    
                    <script>
                        $('#fechaInicio').datepicker({
                            dateFormat: 'yy-mm-dd',
                            startDate: '+3d'
                        });

                        //$("#fechaInicio").datepicker("disable");
                            
                    </script>

                    <script>
                        function ver(){
                            alert(" R:" + window.room + " D:" + window.date + "  H:" + window.hour + " S:" + window.service);
                        }
                        function asignarRoom(id_room,lat,lng){
                            initMap(lat,lng);
                            window.service = {{id_service}};
    	                    window.room=id_room;
                            //document.getElementById('fechaInicio').value = "";
                            document.getElementById('fechaInicio').type = "text";
                            window.date = undefined;
                            if( document.getElementById('arrayNuevo')){
                                var element = document.getElementById('arrayNuevo');
                                element.parentNode.removeChild(element);
                            }
                        }
                        function asignarFecha(){
                            if(window.room == undefined){
                                alert('Selecciona un campus antes de asignar una fecha');
                                document.getElementById('fechaInicio').value = "";
                            }else{
    	                        window.date=document.getElementById('fechaInicio').value;
                                window.hour = undefined;
                                $.ajax({url: "/servicio/listaEventos/" + window.service + "/" + window.room+ "/" + window.date})
                                        .done(function (data) {
                                            $('#arrayContenedor').html(data);
                                        });
                            } 
                        }
                        function asignarHora(value){
                            document.getElementById("botonSeleccion").innerText = value + " hrs";
                            window.hour = value;
                        }
                        function comprar(){
                            if(window.service != undefined && window.room != undefined && window.date != undefined && window.hour != undefined){
                                var name = document.getElementById("service-name").innerHTML;
                                window.location.href = '/comprar/2/'+ window.service + "|" + window.room + "|" + window.date + "|" + window.hour + "|" + name;
                            }else{
                                alert("Selecciona el aula la fecha y la hora para poder apartarlo");
                            }
                        }
                    </script>
                    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBDaeWicvigtP9xPv919E-RNoxfvC-Hqik&callback=initMap">
                    </script>
                </div>
            </div>
        </div>
    </div>
    {{/each}}
</div>